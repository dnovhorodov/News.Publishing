# News.Publishing

## 🌟 Overview
The **News.Publishing.Api** is a backend for managing the publishing flow of articles and videos. This service coordinates the creation, linking, and publication of content.

![flow](docs/publishing.png)

## 📂 Repository Structure
Below is the structure of the repository to give you an understanding of how this service is organized:

- 📂 `src/`
    - 📂 `News.Publishing/`
        - 📁 **Features**: Implementation of key features such as `CreatePublication`, `IngestVideo`, `LinkArticle`, etc.
        - 📜 **`IntegrationEvents.cs`**: Defines all integration events used to communicate with other services.
    - 📂 `News.Publishing.Api/`
        - 📁 **Requests**: Contains request handlers and API endpoints, defined using ASP.NET Core.
        - 📁 **Infrastructure**: Handles dependencies such as configurations, middleware, and logging.
        - 📁 **Internal**: Auto-generated by Marten. Do not modify!
        - 📁 **Requests**: Sample request for playing locally
- 📂 `test/`
    - **Acceptance and Integration Tests**: Implements tests for key features using **FluentAssertions**, **Ogooreck**, and **Bogus** for generating realistic test data.

## 💻 Technologies Used
- 🛠️ **.NET 8**
- 📡 **[MassTransit](https://masstransit.io/)**: Provides RabbitMQ integration for the event-driven communication between services.
- 📦 **[Marten](https://github.com/JasperFx/marten)**: Used for event sourcing and data persistence.
- 🐳 **Docker & Docker Compose**: Used for containerizing the service and running it in different environments.

## 🚀 Getting Started
### 🔧 Prerequisites

- 🛠️ .NET SDK 8.0+ (Available [here](https://dotnet.microsoft.com/download))
- 🐳 PostgreSQL 12+ (Available [here](https://www.postgresql.org/download/)) 
- 🐳 Docker (Available [here](https://docs.docker.com/engine/install/))
- 🐰 RabbitMQ (Available [here](https://www.rabbitmq.com/docs/download))

The fastest possible way to develop with is to run PostgreSQL and RabbitMQ in a Docker container. Assuming that you have Docker running on your local box, type:
`docker compose up -d postgres rabbitmq`

### ▶️ Running the Service
1. **Clone the repository**:
    ```shell
    git clone https://github.com/dnovhorodov/News.Publishing.git
    cd News.Publishing
    ```

2. **Run dependencies**:
    ```shell
    docker compose up -d postgres rabbitmq
    ```

3. **Run service**:
    ```shell
    dotnet run --project ./src/News.Publishing.Api/News.Publishing.Api.csproj
    ```
4. **API Documentation**: Swagger is enabled for API documentation.
   Once the service is running, navigate to `http://localhost:5267/swagger/index.html` to explore the endpoints.

### 🧪 Testing
The service includes acceptance and integration tests to validate its functionality.

- 🧷 [FluentAssertions](https://github.com/fluentassertions/fluentassertions): For expressive assertions in unit tests.
- 📝 [Ogooreck](https://github.com/oskardudycz/Ogooreck): For BDD-style testing and scenario definitions.
- 🎲 [Bogus](https://github.com/bchavez/Bogus): For generating fake data to test various edge cases.